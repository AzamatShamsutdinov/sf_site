Changes from Evgenii Peshkov 2